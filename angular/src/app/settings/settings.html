<div class="container mt-5">
  <div class="card border-0 shadow-sm mw-100 mx-auto" style="max-width: 600px;">

    <div class="card-body p-4">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="fw-bold mb-0">âš™ï¸ ConfiguraciÃ³n</h3>
        <div *ngIf="isLoading" class="spinner-border spinner-border-sm text-primary" role="status"></div>
      </div>

      <div class="d-flex justify-content-between align-items-center p-3 border rounded bg-light mb-4">
        <div>
          <h5 class="fw-bold mb-1">Notificaciones Generales</h5>
          <p class="text-muted mb-0 small">
            {{ notificationsEnabled ? 'âœ… Recibiendo alertas' : 'ğŸ”• No molestar' }}
          </p>
        </div>

        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" style="width: 3em; height: 1.5em; cursor: pointer;"
            [checked]="notificationsEnabled" (change)="toggleNotifications()" [disabled]="isLoading">
        </div>
      </div>

      <hr class="text-muted my-4 opacity-25">

      <div [class.opacity-50]="!notificationsEnabled" [class.pe-none]="!notificationsEnabled">
        <h5 class="fw-bold mb-3">ğŸ“¡ Canal de Preferencia</h5>

        <div class="form-group">
          <label for="prefSelect" class="form-label text-muted small">Â¿DÃ³nde quieres recibir los avisos?</label>

          <select id="prefSelect" class="form-select form-select-lg" [(ngModel)]="currentPreference"
            (change)="savePreference()" [disabled]="isLoading || !notificationsEnabled">

            <option value="Ambas">ğŸ“§ Email y ğŸ–¥ï¸ Pantalla (Recomendado)</option>
            <option value="Mail">ğŸ“§ Solo Email</option>
            <option value="Pantalla">ğŸ–¥ï¸ Solo Pantalla</option>
          </select>
        </div>

        <div *ngIf="saved" class="mt-2 text-success small fw-bold fade-in">
          âœ… Preferencia guardada
        </div>

        <div *ngIf="!notificationsEnabled" class="mt-2 text-warning small">
          <i class="fa fa-info-circle"></i> Enciende el interruptor de arriba para editar esto.
        </div>
      </div>

    </div>
  </div>
</div>