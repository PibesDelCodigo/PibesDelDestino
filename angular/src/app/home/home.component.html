<div class="home-container">

  <div class="hero-section">
    <div class="hero-overlay"></div>
    <div class="hero-content container">
      <img src="assets/images/logo/logo-white.png" alt="Pibes del Destino" class="hero-logo animate-up">
      
      <h1 class="animate-up">¬°Tu pr√≥xima aventura empieza ac√°!</h1>
      <p class="animate-up delay-1">Descubr√≠ las mejores ciudades del mundo seg√∫n viajeros como vos.</p>
      
      <div class="mt-4 animate-up delay-2">
        <ng-container *ngIf="!hasLoggedIn">
          <button class="btn btn-primary btn-lg me-3" (click)="login()">
            <i class="fa fa-sign-in-alt me-2"></i> Iniciar Sesi√≥n para Calificar
          </button>
        </ng-container>

        <ng-container *ngIf="hasLoggedIn">
          <button class="btn btn-light btn-lg text-primary fw-bold" (click)="goToExplore()">
            <i class="fa fa-compass me-2"></i> Explorar Ahora
          </button>
        </ng-container>
      </div>
    </div>
  </div>

  <div class="container py-5">
    <div class="row g-4 justify-content-center stats-row">
      <div class="col-md-4" (click)="goToTopDestinations()" style="cursor: pointer;">
        <div class="feature-card">
          <div class="icon-circle bg-blue">
            <i class="fas fa-plane-departure"></i>
          </div>
          <h3>Destinos Top</h3>
          <p>Mir√° el ranking de los lugares m√°s votados.</p>
        </div>
      </div>
      <div class="col-md-4" (click)="goToMyFavorites()" style="cursor: pointer;">
        <div class="feature-card">
          <div class="icon-circle bg-orange">
            <i class="fas fa-star"></i>
          </div>
          <h3>Tus Favoritos</h3>
          <p>Guard√° los destinos que quer√©s visitar.</p>
        </div>
      </div>
      <div class="col-md-4" (click)="goToCommunity()" style="cursor: pointer;">
        <div class="feature-card">
          <div class="icon-circle bg-blue">
            <i class="fas fa-comments"></i>
          </div>
          <h3>Comunidad</h3>
          <p>Le√© rese√±as reales de otros viajeros.</p>
        </div>
      </div>
    </div>
  </div>

  <div id="ranking-section" class="destinations-section bg-light py-5">
    <div class="container">
      
      <div class="section-header text-center mb-5">
        <span class="badge bg-warning text-dark mb-2">Ranking Global</span>
        <h2 class="fw-bold section-title">Destinos M√°s Populares</h2>
        <div class="divider mx-auto"></div>
      </div>

      <div *ngIf="isLoadingTop" class="text-center py-5">
        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
        <p class="mt-3 text-muted">Buscando destinos incre√≠bles...</p>
      </div>

      <div *ngIf="!isLoadingTop && topDestinations.length === 0" class="text-center text-muted py-5 empty-state">
        <i class="fas fa-map-marked-alt fa-4x mb-3 text-secondary opacity-50"></i>
        <h3>¬°Ups! A√∫n no hay datos</h3>
        <p>S√© el primero en calificar un destino.</p>
      </div>

      <div class="row g-4" *ngIf="!isLoadingTop && topDestinations.length > 0">
        <div class="col-md-4 col-sm-6" *ngFor="let dest of topDestinations; let i = index">
          <div class="card destination-card h-100 border-0 shadow-sm" (click)="goToDetail(dest.id)" style="cursor: pointer;">
            
            <div *ngIf="i < 3" class="ranking-badge shadow">
              <span *ngIf="i===0">ü•á</span>
              <span *ngIf="i===1">ü•à</span>
              <span *ngIf="i===2">ü•â</span>
              #{{ i + 1 }}
            </div>

            <div class="card-img-wrapper">
              <img [src]="dest.photo || 'https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?q=80&w=600&auto=format&fit=crop'" 
                   class="card-img-top" 
                   alt="{{ dest.name }}">
              <div class="img-overlay"></div>
            </div>

            <div class="card-body p-4 d-flex flex-column">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="card-title fw-bold mb-0 text-dark">{{ dest.name }}</h5>
                <span class="country-badge">
                  <i class="fas fa-map-marker-alt"></i> {{ dest.country }}
                </span>
              </div>

              <div class="rating-stars mb-3">
                <span *ngFor="let s of [1,2,3,4,5]" class="me-1">
                     <i [class]="s <= (dest.averageRating || 0) ? 'fas fa-star text-warning' : 'far fa-star text-muted'"></i>
                </span>
                <span class="fw-bold text-dark ms-1">{{ (dest.averageRating || 0) | number:'1.1-1' }}</span>
              </div>

              <button class="btn btn-outline-primary w-100 mt-auto rounded-pill fw-bold" (click)="goToDetail(dest.id); $event.stopPropagation()">
                Ver Detalles <i class="fas fa-arrow-right ms-2"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="community-section py-5">
    <div class="container">
      <div class="section-header text-center mb-5">
        <h2 class="fw-bold section-title">Actividad de la Comunidad</h2>
        <div class="divider mx-auto"></div>
      </div>

      <div *ngIf="isLoadingCommunity" class="text-center py-4">
        <div class="spinner-border text-primary spinner-border-sm" role="status"></div>
      </div>

      <div class="row justify-content-center" *ngIf="!isLoadingCommunity">
        <div class="col-lg-8">
          
          <div class="card border-0 shadow-sm mb-3 animate-up" *ngFor="let exp of recentExperiences">
            <div class="card-body d-flex align-items-center">
              
              <div class="me-3">
                <ng-container *ngIf="exp.userProfilePicture && exp.userProfilePicture.length > 5">
                  <img [src]="exp.userProfilePicture" 
                       class="rounded-circle shadow-sm" 
                       style="width: 45px; height: 45px; object-fit: cover; display: block;"
                       alt="Avatar"
                       (error)="exp.userProfilePicture = ''">
                </ng-container>

                <ng-container *ngIf="!exp.userProfilePicture || exp.userProfilePicture.length <= 5">
                  <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center shadow-sm" 
                       style="width: 45px; height: 45px; font-weight: bold; font-size: 1.2rem; min-width: 45px;">
                    {{ (exp.userName ? exp.userName.charAt(0) : 'U') | uppercase }}
                  </div>
                </ng-container>
              </div>

              <div>
                <h6 class="mb-0 fw-bold">{{ exp.userName }}</h6>
                <p class="mb-0 text-muted small">Escribi√≥: "{{ exp.title }}"</p>
              </div>

              <div class="ms-auto text-warning fw-bold">
                ‚òÖ {{ exp.rating }}
              </div>
            </div>
          </div>
          
          <div class="text-center mt-4">
            <button class="btn btn-link text-primary fw-bold text-decoration-none" (click)="goToCommunity()">
              Ver todas las experiencias <i class="fas fa-chevron-right ms-1"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>